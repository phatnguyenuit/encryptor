{"version":3,"sources":["pages/Encrypt/index.tsx","lib/encryption.ts","hooks/useEncryptionForm.ts"],"names":["EncryptPageComponent","useState","encryptedText","setEncryptedText","useEncryptionForm","algorithm","password","text","handleChangeAlgorithm","handleChangePassword","handleChangeText","handleEncrypt","useCallback","e","a","preventDefault","encryption","Encryption","encrypt","encryptedValue","toString","action","noValidate","onSubmit","className","htmlFor","required","id","value","onChange","ALGORITHMS","map","_algorithm","key","type","rows","readOnly","to","EncryptPage","memo","displayName","cipher","decipher","Buffer","alloc","iv","password_buffer","from","concat","length","this","crypto","createCipheriv","createDecipheriv","data","Promise","resolve","reject","update","final","exception","getCiphers","setAlgorithm","setPassword","setText","target"],"mappings":"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","file":"static/js/5.74fd4cd3.chunk.js","sourcesContent":["import React, { memo, useState, useCallback, FormEvent } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport Encryption from 'lib/encryption';\nimport useEncryptionForm, { ALGORITHMS } from 'hooks/useEncryptionForm';\n\n\nexport const EncryptPageComponent: React.FC = () => {\n\tconst [encryptedText, setEncryptedText] = useState('');\n\tconst { \n\t\talgorithm, \n\t\tpassword, \n\t\ttext, \n\t\thandleChangeAlgorithm, \n\t\thandleChangePassword, \n\t\thandleChangeText \n\t} = useEncryptionForm();\n\n\tconst handleEncrypt = useCallback(\n\t\tasync (e: FormEvent<HTMLFormElement>) => {\n\t\t\te.preventDefault();\n\n\t\t\tconst encryption = new Encryption(algorithm, password);\n\t\t\tconst encryptedValue = await encryption.encrypt(text);\n\t\t\tsetEncryptedText(encryptedValue.toString('hex'));\n\t\t},\n\t\t[algorithm, password, text],\n\t);\n\n\treturn (\n\t\t<div>\n\t\t\t<h1>Encrypt</h1>\n\t\t\t<form action=\"#\" noValidate onSubmit={handleEncrypt}>\n\t\t\t\t<div className=\"form-control\">\n\t\t\t\t\t<label htmlFor=\"algorithm\">Algorithm</label>\n\t\t\t\t\t<select required \n\t\t\t\t\t\tid=\"algorithm\" \n\t\t\t\t\t\tvalue={algorithm} \n\t\t\t\t\t\tonChange={handleChangeAlgorithm}\n\t\t\t\t\t>\n\t\t\t\t\t\t{ALGORITHMS.map((_algorithm) => (\n\t\t\t\t\t\t\t<option key={_algorithm} value={_algorithm}>\n\t\t\t\t\t\t\t\t{_algorithm}\n\t\t\t\t\t\t\t</option>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</select>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"form-control\">\n\t\t\t\t\t<label htmlFor=\"password\">Password</label>\n\t\t\t\t\t<input id=\"password\" value={password} onChange={handleChangePassword} type=\"password\" />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"form-control\">\n\t\t\t\t\t<label htmlFor=\"text\">Text to encrypt</label>\n\t\t\t\t\t<textarea id=\"text\" value={text} onChange={handleChangeText} rows={3}></textarea>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"form-control\">\n\t\t\t\t\t<label htmlFor=\"encryptedText\">Encrypted(in HEX)</label>\n\t\t\t\t\t<textarea readOnly id=\"encryptedText\" value={encryptedText} rows={3}></textarea>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"form-buttons\">\n\t\t\t\t\t<button type=\"submit\">Encrypt</button>\n\t\t\t\t\t<Link to=\"/decrypt\">Decrypt</Link>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</div>\n\t);\n};\n\nconst EncryptPage = memo(EncryptPageComponent);\nEncryptPage.displayName = 'EncryptPage';\n\nexport default EncryptPage;\n","import crypto from \"crypto\";\n\nclass Encryption {\n  private cipher: crypto.Cipher;\n  private decipher: crypto.Decipher;\n  /**\n   *\n   * @param {*} algorithm crypto.getCiphers()\n   * @param {*} password password\n   */\n  constructor(algorithm: string, password: string) {\n    let key = Buffer.alloc(32); // key should be 32 bytes\n    let iv = Buffer.alloc(16); // iv should be 16\n\n    const password_buffer = Buffer.from(password);\n\n    key = Buffer.concat([password_buffer], key.length);\n    iv = Buffer.concat([password_buffer], iv.length);\n\n    this.cipher = crypto.createCipheriv(algorithm, key, iv);\n    this.decipher = crypto.createDecipheriv(algorithm, key, iv);\n  }\n  encrypt(data: string): Promise<Buffer> {\n    return new Promise((resolve, reject) => {\n      try {\n        const encrypted = Buffer.concat([\n          this.cipher.update(data, \"utf8\"),\n          this.cipher.final(),\n        ]);\n        resolve(encrypted);\n      } catch (exception) {\n        reject(exception);\n      }\n    });\n  }\n\n  decrypt(data: NodeJS.ArrayBufferView): Promise<Buffer> {\n    return new Promise((resolve, reject) => {\n      try {\n        const decrypted = Buffer.concat([\n          this.decipher.update(data),\n          this.decipher.final(),\n        ]);\n        resolve(decrypted);\n      } catch (exception) {\n        reject(exception);\n      }\n    });\n  }\n}\n\nexport default Encryption;\n","import { useState, useCallback, ChangeEvent } from 'react';\n\nimport crypto from 'crypto';\n\nexport const ALGORITHMS = crypto.getCiphers();\nconst defaultAlgorithm = 'aes-256-cbc';\n\nconst useEncryptionForm = () => {\n  const [algorithm, setAlgorithm] = useState(defaultAlgorithm);\n\tconst [password, setPassword] = useState('');\n\tconst [text, setText] = useState('');\n\n\tconst handleChangeAlgorithm = useCallback((e: ChangeEvent<HTMLSelectElement>) => {\n\t\tsetAlgorithm(e.target.value);\n\t}, []);\n\n\tconst handleChangePassword = useCallback((e: ChangeEvent<HTMLInputElement>) => {\n\t\tsetPassword(e.target.value);\n\t}, []);\n\n\tconst handleChangeText = useCallback((e: ChangeEvent<HTMLTextAreaElement>) => {\n\t\tsetText(e.target.value);\n\t}, []);\n  return {\n    algorithm,\n    password,\n    text,\n    handleChangeAlgorithm,\n    handleChangePassword,\n    handleChangeText,\n  }\n}\n\nexport default useEncryptionForm;\n"],"sourceRoot":""}